
# Глава 5: Мрежов слой

Мрежовият слой е третият слой от OSI модела и е отговорен за маршрутизацията, логическото адресиране и преноса на пакети от данни между различни мрежи. Той осигурява пътя за предаване на данни от източника до крайната цел, дори ако устройствата се намират в различни мрежи.

## 5.1. Рутинг и маршрутизация
Мрежовият слой използва маршрутизация, за да определя най-ефективния път за предаване на данни. Това се постига чрез:

### Рутинг (Routing):
Процесът на избор на маршрут за предаване на данни между мрежите.  
Рутерите са основните устройства, които извършват тази задача.

**Основни функции на маршрутизацията:**
- **Динамичен рутинг:**  
  Използва протоколи като OSPF (Open Shortest Path First) и RIP (Routing Information Protocol) за автоматично обновяване на маршрутите.
- **Статичен рутинг:**  
  Администраторът предварително конфигурира маршрути. Подходящо за малки мрежи.
- **Рутинг таблици:**  
  Списък с мрежови пътища, съхраняван в рутерите, който определя къде трябва да бъдат насочени пакетите.

### Пример:
Когато потребител от България изпраща имейл до потребител в Япония, мрежовият слой използва рутери, за да насочи данните през най-оптималния път.

## 5.2. Протоколи на мрежовия слой
Мрежовият слой използва протоколи за адресиране и маршрутизация. Основните протоколи включват:

### 5.2.1. IP (Internet Protocol):
- **IPv4:**  
  Най-широко използваната версия, с 32-битови адреси (напр. 192.168.1.1).  
  Ограничен брой адреси (около 4.3 милиарда).
- **IPv6:**  
  Използва 128-битови адреси, което позволява огромен брой уникални адреси.  
  Пример: 2001:0db8:85a3:0000:0000:8a2e:0370:7334.

### 5.2.2. ICMP (Internet Control Message Protocol):
Използва се за диагностика на мрежови проблеми.  
**Пример:** Командата `ping` проверява дали устройството е достъпно.

### 5.2.3. ARP (Address Resolution Protocol):
Превръща IP адресите в MAC адреси, необходими за комуникация в локална мрежа.

### 5.2.4. NAT (Network Address Translation):
Позволява няколко устройства в локална мрежа да използват един публичен IP адрес за интернет достъп.  
**Пример:** Домашен рутер с частен IP адрес (192.168.1.1).

## 5.3. Адресиране: IPv4 и IPv6

### 5.3.1. IPv4:
- **Структура:** Разделен на четири части (октети), всяка от които съдържа стойност между 0 и 255.  
  Пример: 192.168.0.1.
- **Класификация:**
  - **Клас A:** За големи мрежи. (напр. 10.0.0.0)
  - **Клас B:** За средни мрежи. (напр. 172.16.0.0)
  - **Клас C:** За малки мрежи. (напр. 192.168.0.0)

### 5.3.2. IPv6:
- **Подобрения:**  
  - По-голям адресен капацитет.  
  - Вградена поддръжка за сигурност и QoS (Quality of Service).
- **Пример:** Устройства като IoT (умни уреди) често използват IPv6.

## 5.4. NAT и подмрежи

### 5.4.1. NAT (Network Address Translation):
- **Функция:**  
  Превръща частните IP адреси в публичен адрес за комуникация с интернет.  
  Това позволява пестене на IP адреси и осигурява допълнителна защита, тъй като частните адреси са невидими отвън.

### 5.4.2. Подмрежи (Subnetting):
- **Цел:**  
  Разделяне на голяма мрежа на по-малки части за по-добро управление.
  
  **Пример:**  
  IP адрес: 192.168.1.0/24.  
  `/24` показва, че първите 24 бита са за мрежата, а останалите 8 бита са за устройства.

## Примерна реализация на мрежов слой:

### Сценарий: Компютър изпраща заявка за уеб страница
1. Мрежовият слой на компютъра добавя IP адреса на уеб сървъра като дестинация.
2. Рутерът използва рутинг таблици, за да определи най-бързия път до сървъра.
3. Уеб сървърът отговаря със съдържанието на страницата.

Това завършва функциите и протоколите на мрежовия слой. Ако сте готови, мога да премина към транспортния слой!
